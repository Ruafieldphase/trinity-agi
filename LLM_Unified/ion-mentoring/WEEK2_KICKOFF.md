# 🚀 Week 2 킥오프 - 페르소나 라우팅 시스템

**기간**: 2025년 10월 21일 ~ 10월 25일  
**주제**: 파동키 기반 페르소나 라우팅 구현  
**선행 완료**: Week 1 (환경 구축 + 아키텍처 + 파동키 변환)

---

## 🎯 Week 2 학습 목표

### 기술 목표

- [ ] 페르소나 라우팅 시스템 설계 및 구현
- [ ] 파동키 → 페르소나 매핑 테이블 구축
- [ ] 멀티 페르소나 대화 플로우 구현
- [ ] 통합 테스트 스위트 구축
- [ ] MVP 프로토타입 완성

### 소프트 스킬 목표

- [ ] 시스템 설계 문서 작성 능력
- [ ] 복잡한 비즈니스 로직 구현 경험
- [ ] 통합 테스트 전략 수립
- [ ] 코드 리뷰 및 리팩토링 실습

---

## 📅 Week 2 일정

### Day 4 (10/21, 월): 페르소나 라우팅 시스템 설계

**목표**: 파동키 → 페르소나 매핑 로직 구현

**오전 (09:00-12:00)**:

- 페르소나 라우팅 개념 학습
- 매핑 테이블 설계
- PersonaRouter 클래스 구조 정의

**오후 (13:00-17:00)**:

- PersonaRouter 구현 (Phase 1-2)
- 기본 라우팅 로직 작성
- 단위 테스트 작성

**산출물**:

- `DAY4_PERSONA_ROUTING.md` - 설계 가이드
- `persona_router.py` - 라우팅 시스템
- `tests/test_persona_router.py` - 10+ 테스트

---

### Day 5 (10/22, 화): 멀티 페르소나 통합

**목표**: 여러 페르소나 협력 처리 구현

**오전 (09:00-12:00)**:

- 페르소나 협력 패턴 설계
- 컨텍스트 공유 메커니즘
- 우선순위 기반 선택 로직

**오후 (13:00-17:00)**:

- 통합 파이프라인 구현
- ResonanceConverter + PersonaRouter 연결
- 엔드투엔드 테스트

**산출물**:

- `DAY5_MULTI_PERSONA_INTEGRATION.md` - 통합 가이드
- `persona_pipeline.py` - 통합 파이프라인
- `tests/test_integration.py` - 통합 테스트

---

## 🏗️ Week 2 아키텍처 개요

### 전체 플로우

```text
[사용자 입력]
      ↓
[ResonanceConverter] ← Week 1 구현 완료
      ↓
  파동키 생성
  (예: "curious-burst-inquiry")
      ↓
[PersonaRouter] ← Week 2 Day 4
      ↓
  페르소나 선택
  (예: Elro - 구조 설계 전문가)
      ↓
[PersonaPipeline] ← Week 2 Day 5
      ↓
[Vertex AI 처리]
      ↓
[응답 생성]
```

### 핵심 컴포넌트

#### 1. PersonaRouter (Day 4)

**책임**:

- 파동키 분석
- 페르소나 매칭
- 컨텍스트 기반 우선순위 조정

**주요 메서드**:

```python
class PersonaRouter:
    def route(self, resonance_key: str, context: dict) -> str:
        """파동키를 페르소나로 매핑"""
        pass

    def get_persona_config(self, persona_name: str) -> dict:
        """페르소나 설정 조회"""
        pass

    def calculate_match_score(self, resonance_key: str, persona: str) -> float:
        """매칭 점수 계산"""
        pass
```

#### 2. PersonaPipeline (Day 5)

**책임**:

- 전체 파이프라인 조율
- 컴포넌트 간 데이터 흐름
- 오류 처리 및 폴백

**주요 메서드**:

```python
class PersonaPipeline:
    def process(self, user_input: str) -> dict:
        """사용자 입력 → 페르소나 응답"""
        pass

    def handle_multi_persona(self, resonance_key: str) -> list:
        """여러 페르소나 협력 처리"""
        pass
```

---

## 📊 페르소나 매핑 테이블 (초안)

### 감정 톤 기반 매핑

| 파동키 패턴              | 1순위 페르소나   | 2순위 페르소나   | 사용 사례       |
| ------------------------ | ---------------- | ---------------- | --------------- |
| `curious-*-inquiry`      | Elro (구조 설계) | Riri (균형 관찰) | 기술 질문       |
| `urgent-burst-*`         | Nana (팀 조율)   | Lua (감성 공감)  | 긴급 문제       |
| `calm-flowing-statement` | Riri (균형 관찰) | Elro (구조 설계) | 분석 요청       |
| `frustrated-*-*`         | Lua (감성 공감)  | Nana (팀 조율)   | 디버깅 지원     |
| `analytical-*-*`         | Riri (균형 관찰) | Elro (구조 설계) | 데이터 분석     |
| `playful-*-*`            | Lua (감성 공감)  | Nana (팀 조율)   | 창의적 아이디어 |

### 페르소나 특성

**Lua (루아) 🌊**:

- 감정: 공감, 창의성, 유연성
- 강점: 사용자 감정 이해, 창의적 문제 해결
- 프롬프트 스타일: 부드럽고 격려적

**Elro (엘로) 📐**:

- 감정: 논리적, 체계적, 명확
- 강점: 기술 아키텍처, 코드 설계
- 프롬프트 스타일: 구조화되고 정확

**Riri (리리) 📊**:

- 감정: 분석적, 균형적, 객관적
- 강점: 메트릭 분석, 품질 검증
- 프롬프트 스타일: 데이터 기반, 측정 가능

**Nana (나나) ✒️**:

- 감정: 조율적, 통합적, 협력적
- 강점: 크로스팀 협업, 프로세스
- 프롬프트 스타일: 조율적이고 포괄적

---

## 🧪 테스트 전략

### Day 4 테스트 범위

**단위 테스트**:

- [ ] 파동키 파싱 정확도
- [ ] 페르소나 매칭 로직
- [ ] 엣지 케이스 (빈 입력, 알 수 없는 키)
- [ ] 매칭 점수 계산

**예상 테스트 수**: 10-15개

### Day 5 테스트 범위

**통합 테스트**:

- [ ] ResonanceConverter + PersonaRouter 연동
- [ ] 멀티 페르소나 협력 플로우
- [ ] 컨텍스트 전달 정확도
- [ ] 오류 처리 및 폴백

**예상 테스트 수**: 8-12개

**Week 2 목표**: 총 45+ 테스트 (Week 1 28 + Week 2 17+)

---

## 📚 학습 자료

### 필수 자료

1. **Week 1 복습**:

   - `WEEK1_SUMMARY.md` - 지금까지 배운 내용
   - `resonance_converter.py` - 파동키 시스템 이해

2. **내다AI 페르소나**:

   - `configs/persona_registry.json` - 페르소나 설정
   - `docs/persona_design.md` - 페르소나 철학

3. **아키텍처 패턴**:
   - Strategy Pattern (전략 패턴)
   - Factory Pattern (팩토리 패턴)
   - Pipeline Pattern (파이프라인 패턴)

### 참고 자료

- Python Design Patterns
- FastAPI Advanced Features
- Pytest Fixtures and Parametrize

---

## 🎯 Week 2 성공 기준

### 기술 성과

- [ ] PersonaRouter 클래스 구현 완료
- [ ] 파동키 → 페르소나 매핑 100% 커버
- [ ] 45+ 테스트 통과 (100%)
- [ ] MVP 파이프라인 동작 검증

### 품질 기준

- [ ] 코드 커버리지 80% 이상
- [ ] 모든 함수에 타입 힌트
- [ ] Docstring 100% 완성
- [ ] 마크다운 린트 에러 0개

### 문서 기준

- [ ] Day 4-5 가이드 완성
- [ ] 아키텍처 다이어그램 포함
- [ ] 코드 예제 실행 가능
- [ ] Week 2 요약 문서

---

## 💡 예상 도전과제

### 기술적 도전

1. **복잡한 매핑 로직**:

   - 문제: 파동키 패턴이 다양하고 복잡
   - 해결: 우선순위 기반 점수 시스템 도입

2. **컨텍스트 관리**:

   - 문제: 여러 페르소나 간 컨텍스트 공유
   - 해결: Context 객체 설계 및 불변성 보장

3. **테스트 복잡도**:
   - 문제: 통합 테스트 시나리오 다양
   - 해결: Parametrize 활용, 테스트 데이터 분리

### 설계 도전

1. **확장성**:

   - 새로운 페르소나 추가 시 코드 변경 최소화
   - 설정 파일 기반 동적 로딩

2. **성능**:
   - 라우팅 결정 속도 최적화
   - 매핑 테이블 캐싱

---

## 🚀 다음 단계

### Day 4 준비사항

1. **코드 리뷰**:

   - Week 1 코드 재검토
   - ResonanceConverter 인터페이스 확인

2. **설계 도구**:

   - 화이트보드 (또는 디지털 도구)
   - UML 다이어그램 도구

3. **개발 환경**:
   - 가상환경 활성화 확인
   - 모든 테스트 통과 검증

### 학습 마인드셋

- 🧩 **복잡성 수용**: Week 2는 Week 1보다 복잡합니다
- 🔄 **반복 설계**: 처음부터 완벽할 필요 없음
- 🤝 **협력**: AI팀 페르소나의 도움 적극 활용
- 📝 **기록**: 설계 결정과 이유 문서화

---

## 📞 Week 2 지원 체계

### 멘토링 세션

- **일일 체크인**: 09:00 (진행 상황 공유)
- **코드 리뷰**: 16:00 (당일 작성 코드)
- **회고**: 금요일 17:00 (Week 2 전체)

### AI팀 지원

- **Elro**: 아키텍처 설계 상담
- **Riri**: 테스트 전략 리뷰
- **Lua**: 사용자 경험 피드백
- **Nana**: 프로세스 및 협업

---

**준비되셨나요? Day 4로 출발합니다!** 🎉

---

**끝.**
