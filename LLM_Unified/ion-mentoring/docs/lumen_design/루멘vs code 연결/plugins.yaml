# Lumen Adaptive Feedback â€” Plugins Configuration (env-aware)
mode: "${PLUGIN_MODE:shell}"   # shell | http | k8s

shell:
  throttle_noncritical_tasks: "echo throttling noncritical tasks by ${THROTTLE_PCT:10}%"
  enable_circuit_breaker: "echo enabling circuit breaker on service ${SERVICE:unknown}"
  scale_down_creative_band_weight: "echo (weights are in-process; no external command)"
  increase_safety_weight: "echo (weights are in-process; no external command)"
  restore_creative_band_weight: "echo restoring creative weight baseline in process"
  decrease_safety_weight: "echo restoring safety weight baseline in process"

http:
  endpoint: "${PLUGIN_HTTP_ENDPOINT:http://localhost:8080/lumen/apply}"
  headers:
    Authorization: "Bearer ${PLUGIN_HTTP_TOKEN:REPLACE_ME}"

k8s:
  context: "${K8S_CONTEXT:}"
  namespace: "${K8S_NAMESPACE:default}"
  throttle_noncritical_tasks: "kubectl ${K8S_CONTEXT:+--context ${K8S_CONTEXT}} -n ${K8S_NAMESPACE} annotate deploy/${SERVICE:myapp} lumen/throttle=${THROTTLE_PCT:10} --overwrite"
  enable_circuit_breaker: "kubectl ${K8S_CONTEXT:+--context ${K8S_CONTEXT}} -n ${K8S_NAMESPACE} label svc/${SERVICE:myapp} lumen/circuit-breaker=enabled --overwrite"
