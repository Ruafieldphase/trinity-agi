{
    "_metadata": {
        "version": "1.0.0",
        "created_at": "2025-11-03T17:25:00",
        "description": "Auto-healing strategies for anomaly detection",
        "author": "GitHub Copilot"
    },
    "strategies": {
        "high_cpu": {
            "name": "High CPU Usage",
            "trigger": {
                "metric": "cpu_percent",
                "condition": "value > upper_threshold"
            },
            "severity": "Warning",
            "actions": [
                {
                    "type": "log",
                    "message": "High CPU detected: {value}%"
                },
                {
                    "type": "rate_limit",
                    "target": "task_queue",
                    "params": {
                        "max_workers": 1,
                        "delay_seconds": 2
                    }
                },
                {
                    "type": "restart_if_critical",
                    "condition": "cpu_percent > 90",
                    "target": "rpa_worker"
                }
            ],
            "rollback": {
                "enabled": true,
                "restore_workers": true
            },
            "grace_period_seconds": 180,
            "max_retries": 3,
            "min_success_rate": 0.70,
            "consecutive_failures_threshold": 3
        },
        "high_memory": {
            "name": "High Memory Usage",
            "trigger": {
                "metric": "memory_percent",
                "condition": "value > upper_threshold"
            },
            "severity": "Warning",
            "actions": [
                {
                    "type": "log",
                    "message": "High Memory detected: {value}%"
                },
                {
                    "type": "clear_cache",
                    "targets": [
                        "lumen",
                        "agi"
                    ]
                },
                {
                    "type": "restart_if_critical",
                    "condition": "memory_percent > 95",
                    "target": "all_workers"
                }
            ],
            "rollback": {
                "enabled": false
            },
            "grace_period_seconds": 180,
            "max_retries": 2,
            "min_success_rate": 0.70,
            "consecutive_failures_threshold": 3
        },
        "low_success_rate": {
            "name": "Low Success Rate",
            "trigger": {
                "metric": "success_rate",
                "condition": "value < lower_threshold"
            },
            "severity": "Critical",
            "actions": [
                {
                    "type": "log",
                    "message": "Low success rate detected: {value}%"
                },
                {
                    "type": "fallback_llm",
                    "from": "vertex_ai",
                    "to": "local_llm"
                },
                {
                    "type": "restart_service",
                    "target": "task_queue_server"
                },
                {
                    "type": "notify",
                    "channels": [
                        "console",
                        "file"
                    ],
                    "message": "Critical: Success rate too low. Manual intervention may be required."
                }
            ],
            "rollback": {
                "enabled": true,
                "restore_llm_config": true
            },
            "grace_period_seconds": 180,
            "max_retries": 3,
            "min_success_rate": 0.70,
            "consecutive_failures_threshold": 3
        },
        "high_latency": {
            "name": "High Latency",
            "trigger": {
                "metric": "avg_latency_ms",
                "condition": "value > upper_threshold"
            },
            "severity": "Warning",
            "actions": [
                {
                    "type": "log",
                    "message": "High latency detected: {value}ms"
                },
                {
                    "type": "enable_cache",
                    "target": "lumen",
                    "ttl_seconds": 3600
                },
                {
                    "type": "scale_workers",
                    "target": "rpa_worker",
                    "action": "increase",
                    "max_workers": 2
                }
            ],
            "rollback": {
                "enabled": true,
                "restore_worker_count": true
            },
            "grace_period_seconds": 180,
            "max_retries": 2,
            "min_success_rate": 0.70,
            "consecutive_failures_threshold": 3
        },
        "queue_stuck": {
            "name": "Queue Stuck",
            "trigger": {
                "metric": "queue_size",
                "condition": "value > upper_threshold AND value > 10"
            },
            "severity": "Critical",
            "actions": [
                {
                    "type": "log",
                    "message": "Queue stuck detected: {value} pending tasks"
                },
                {
                    "type": "restart_service",
                    "target": "rpa_worker"
                },
                {
                    "type": "redistribute_tasks",
                    "max_tasks_per_worker": 5
                }
            ],
            "rollback": {
                "enabled": false
            },
            "grace_period_seconds": 180,
            "max_retries": 2,
            "min_success_rate": 0.70,
            "consecutive_failures_threshold": 3
        },
        "ml_composite_anomaly": {
            "name": "ML Composite Anomaly",
            "trigger": {
                "metric": "ml_composite",
                "condition": "anomaly_score < mean_score - 2*std"
            },
            "severity": "Info",
            "actions": [
                {
                    "type": "log",
                    "message": "ML detected composite anomaly: score={anomaly_score:.3f}"
                },
                {
                    "type": "snapshot",
                    "target": "system_state",
                    "output": "outputs/anomaly_snapshots/ml_{timestamp}.json"
                }
            ],
            "rollback": {
                "enabled": false
            },
            "grace_period_seconds": 180,
            "max_retries": 1,
            "min_success_rate": 0.70,
            "consecutive_failures_threshold": 3
        }
    },
    "global_settings": {
        "max_concurrent_healings": 1,
        "enable_rollback_on_failure": true,
        "dry_run": false,
        "log_all_actions": true,
        "notification_channels": [
            "console",
            "file"
        ]
    }
}