<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comet í™˜ê²½ í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 30px;
            backdrop-filter: blur(10px);
        }

        h1 {
            text-align: center;
            margin-bottom: 30px;
        }

        .test-section {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            transition: background 0.3s;
        }

        button:hover {
            background: #45a049;
        }

        button:disabled {
            background: #cccccc;
            cursor: not-allowed;
        }

        .result {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
            padding: 15px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            max-height: 200px;
            overflow-y: auto;
        }

        .success {
            color: #4CAF50;
        }

        .error {
            color: #f44336;
        }

        .info {
            color: #2196F3;
        }

        #finalReport {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
            display: none;
        }

        .report-item {
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            background: rgba(0, 0, 0, 0.2);
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>ğŸš€ Comet í™˜ê²½ ìë™ ì§„ë‹¨</h1>

        <div class="test-section">
            <h3>í…ŒìŠ¤íŠ¸ 1: JavaScript ì‹¤í–‰</h3>
            <button onclick="testJavaScript()">í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
            <div id="jsResult" class="result" style="display:none;"></div>
        </div>

        <div class="test-section">
            <h3>í…ŒìŠ¤íŠ¸ 2: Fetch API (ì™¸ë¶€ API)</h3>
            <button onclick="testFetchExternal()">í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
            <div id="fetchExternalResult" class="result" style="display:none;"></div>
        </div>

        <div class="test-section">
            <h3>í…ŒìŠ¤íŠ¸ 3: Fetch API (Localhost)</h3>
            <button onclick="testFetchLocalhost()">í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
            <div id="fetchLocalResult" class="result" style="display:none;"></div>
        </div>

        <div class="test-section">
            <h3>í…ŒìŠ¤íŠ¸ 4: LocalStorage</h3>
            <button onclick="testLocalStorage()">í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
            <div id="storageResult" class="result" style="display:none;"></div>
        </div>

        <div class="test-section">
            <h3>í…ŒìŠ¤íŠ¸ 5: File System Access API</h3>
            <button onclick="testFileSystem()">í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
            <div id="fileSystemResult" class="result" style="display:none;"></div>
        </div>

        <div style="text-align: center; margin-top: 30px;">
            <button onclick="runAllTests()" style="background: #FF9800; font-size: 18px; padding: 15px 40px;">
                â–¶ï¸ ëª¨ë“  í…ŒìŠ¤íŠ¸ í•œë²ˆì— ì‹¤í–‰
            </button>
        </div>

        <div id="finalReport">
            <h2>ğŸ“Š ìµœì¢… ì§„ë‹¨ ê²°ê³¼</h2>
            <div id="reportContent"></div>
            <button onclick="copyReport()" style="background: #2196F3; margin-top: 20px;">
                ğŸ“‹ ê²°ê³¼ ë³µì‚¬í•˜ê¸°
            </button>
        </div>
    </div>

    <script>
        const results = {
            javascript: null,
            fetchExternal: null,
            fetchLocal: null,
            localStorage: null,
            fileSystem: null
        };

        function log(elementId, message, type = 'info') {
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            const className = type === 'success' ? 'success' : type === 'error' ? 'error' : 'info';
            element.innerHTML += `<span class="${className}">${message}</span>\n`;
        }

        function testJavaScript() {
            const resultId = 'jsResult';
            document.getElementById(resultId).innerHTML = '';
            log(resultId, 'ğŸ” JavaScript ì‹¤í–‰ í…ŒìŠ¤íŠ¸ ì¤‘...', 'info');

            try {
                const date = new Date();
                const userAgent = navigator.userAgent;
                const platform = navigator.platform;

                log(resultId, `âœ… JavaScript ì‹¤í–‰ ì„±ê³µ!`, 'success');
                log(resultId, `í˜„ì¬ ì‹œê°: ${date.toLocaleString('ko-KR')}`, 'info');
                log(resultId, `ë¸Œë¼ìš°ì €: ${userAgent}`, 'info');
                log(resultId, `í”Œë«í¼: ${platform}`, 'info');

                results.javascript = true;
            } catch (error) {
                log(resultId, `âŒ JavaScript ì‹¤í–‰ ì‹¤íŒ¨: ${error.message}`, 'error');
                results.javascript = false;
            }
        }

        async function testFetchExternal() {
            const resultId = 'fetchExternalResult';
            document.getElementById(resultId).innerHTML = '';
            log(resultId, 'ğŸ” ì™¸ë¶€ API í˜¸ì¶œ í…ŒìŠ¤íŠ¸ ì¤‘...', 'info');

            try {
                const response = await fetch('https://api.github.com/zen', {
                    method: 'GET'
                });

                if (response.ok) {
                    const text = await response.text();
                    log(resultId, `âœ… ì™¸ë¶€ API í˜¸ì¶œ ì„±ê³µ!`, 'success');
                    log(resultId, `GitHub Zen: "${text}"`, 'info');
                    results.fetchExternal = true;
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                log(resultId, `âŒ ì™¸ë¶€ API í˜¸ì¶œ ì‹¤íŒ¨: ${error.message}`, 'error');
                results.fetchExternal = false;
            }
        }

        async function testFetchLocalhost() {
            const resultId = 'fetchLocalResult';
            document.getElementById(resultId).innerHTML = '';
            log(resultId, 'ğŸ” Localhost API í˜¸ì¶œ í…ŒìŠ¤íŠ¸ ì¤‘...', 'info');

            try {
                const response = await fetch('http://localhost:8091/health', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    const data = await response.json();
                    log(resultId, `âœ… Localhost API í˜¸ì¶œ ì„±ê³µ!`, 'success');
                    log(resultId, `ì‘ë‹µ: ${JSON.stringify(data, null, 2)}`, 'info');
                    results.fetchLocal = true;
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                log(resultId, `âŒ Localhost API í˜¸ì¶œ ì‹¤íŒ¨: ${error.message}`, 'error');
                log(resultId, `ğŸ’¡ API ì„œë²„ê°€ ì‹¤í–‰ë˜ì§€ ì•Šì•˜ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤`, 'info');
                results.fetchLocal = false;
            }
        }

        function testLocalStorage() {
            const resultId = 'storageResult';
            document.getElementById(resultId).innerHTML = '';
            log(resultId, 'ğŸ” LocalStorage í…ŒìŠ¤íŠ¸ ì¤‘...', 'info');

            try {
                const testKey = 'comet_test_' + Date.now();
                const testValue = 'Hello from Comet!';

                localStorage.setItem(testKey, testValue);
                const retrieved = localStorage.getItem(testKey);
                localStorage.removeItem(testKey);

                if (retrieved === testValue) {
                    log(resultId, `âœ… LocalStorage ì½ê¸°/ì“°ê¸° ì„±ê³µ!`, 'success');
                    log(resultId, `ì €ì¥ í…ŒìŠ¤íŠ¸: "${testValue}"`, 'info');
                    results.localStorage = true;
                } else {
                    throw new Error('ê°’ì´ ì¼ì¹˜í•˜ì§€ ì•ŠìŒ');
                }
            } catch (error) {
                log(resultId, `âŒ LocalStorage ì‹¤íŒ¨: ${error.message}`, 'error');
                results.localStorage = false;
            }
        }

        async function testFileSystem() {
            const resultId = 'fileSystemResult';
            document.getElementById(resultId).innerHTML = '';
            log(resultId, 'ğŸ” File System Access API í…ŒìŠ¤íŠ¸ ì¤‘...', 'info');

            try {
                if ('showDirectoryPicker' in window) {
                    log(resultId, `âœ… File System Access API ì§€ì›ë¨!`, 'success');
                    log(resultId, `ğŸ’¡ ì‚¬ìš©ì í´ë¦­ìœ¼ë¡œ í´ë” ì„ íƒ ê°€ëŠ¥`, 'info');
                    log(resultId, `âš ï¸ ìë™ í…ŒìŠ¤íŠ¸ëŠ” ë¶ˆê°€ëŠ¥ (ì‚¬ìš©ì ì œìŠ¤ì²˜ í•„ìš”)`, 'info');
                    results.fileSystem = 'supported_but_requires_gesture';
                } else {
                    throw new Error('File System Access API ë¯¸ì§€ì›');
                }
            } catch (error) {
                log(resultId, `âŒ File System Access API ë¯¸ì§€ì›: ${error.message}`, 'error');
                log(resultId, `ğŸ’¡ Chrome 86+ ë˜ëŠ” Edge 86+ í•„ìš”`, 'info');
                results.fileSystem = false;
            }
        }

        async function runAllTests() {
            testJavaScript();
            await new Promise(resolve => setTimeout(resolve, 500));
            await testFetchExternal();
            await new Promise(resolve => setTimeout(resolve, 500));
            await testFetchLocalhost();
            await new Promise(resolve => setTimeout(resolve, 500));
            testLocalStorage();
            await new Promise(resolve => setTimeout(resolve, 500));
            await testFileSystem();

            setTimeout(generateFinalReport, 1000);
        }

        function generateFinalReport() {
            const report = document.getElementById('finalReport');
            const content = document.getElementById('reportContent');

            let html = '<div class="report-item">';
            html += '<h3>Comet í™˜ê²½ ì§„ë‹¨ ë³´ê³ ì„œ</h3>';
            html += `<p>ì§„ë‹¨ ì‹œê°: ${new Date().toLocaleString('ko-KR')}</p>`;
            html += '</div>';

            html += `<div class="report-item">
                <strong>1. JavaScript ì‹¤í–‰:</strong> ${results.javascript ? 'âœ… ê°€ëŠ¥' : 'âŒ ë¶ˆê°€ëŠ¥'}
            </div>`;

            html += `<div class="report-item">
                <strong>2. ì™¸ë¶€ API í˜¸ì¶œ (fetch):</strong> ${results.fetchExternal ? 'âœ… ê°€ëŠ¥' : 'âŒ ë¶ˆê°€ëŠ¥'}
            </div>`;

            html += `<div class="report-item">
                <strong>3. Localhost API í˜¸ì¶œ:</strong> ${results.fetchLocal ? 'âœ… ê°€ëŠ¥' : 'âŒ ë¶ˆê°€ëŠ¥ (ì„œë²„ ë¯¸ì‹¤í–‰)'}
            </div>`;

            html += `<div class="report-item">
                <strong>4. LocalStorage:</strong> ${results.localStorage ? 'âœ… ê°€ëŠ¥' : 'âŒ ë¶ˆê°€ëŠ¥'}
            </div>`;

            html += `<div class="report-item">
                <strong>5. File System Access:</strong> ${results.fileSystem === 'supported_but_requires_gesture' ? 'âš ï¸ ì§€ì›ë¨ (ì‚¬ìš©ì í´ë¦­ í•„ìš”)' : results.fileSystem ? 'âœ… ê°€ëŠ¥' : 'âŒ ë¶ˆê°€ëŠ¥'}
            </div>`;

            html += '<div class="report-item" style="background: rgba(76, 175, 80, 0.3);">';
            html += '<h4>ğŸ’¡ ì¶”ì²œ ì‘ì—… ë°©ì‹:</h4>';

            if (results.fetchLocal) {
                html += '<p><strong>âœ… HTTP API ë°©ì‹ (ìµœì )</strong><br>';
                html += 'Localhost API ì„œë²„ë¥¼ í†µí•œ ì‘ì—… ì²˜ë¦¬ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.<br>';
                html += 'ë¸Œë¼ìš°ì € ì›Œì»¤ ìŠ¤í¬ë¦½íŠ¸(<code>comet_browser_worker.js</code>)ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.</p>';
            } else if (results.fetchExternal) {
                html += '<p><strong>âš ï¸ HTTP API ë°©ì‹ (API ì„œë²„ í•„ìš”)</strong><br>';
                html += 'Fetch APIëŠ” ì‘ë™í•˜ì§€ë§Œ localhost ì„œë²„ê°€ ì‹¤í–‰ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.<br>';
                html += 'API ì„œë²„ë¥¼ ì‹œì‘í•œ í›„ ë¸Œë¼ìš°ì € ì›Œì»¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>';
            } else if (results.localStorage) {
                html += '<p><strong>ğŸ“¦ LocalStorage ë°©ì‹</strong><br>';
                html += 'API í˜¸ì¶œì´ ë¶ˆê°€ëŠ¥í•˜ì§€ë§Œ LocalStorageëŠ” ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.<br>';
                html += 'ëŒ€ì•ˆ: ë©”ì‹œì§€ ê¸°ë°˜ í†µì‹  ë˜ëŠ” íŒŒì¼ ì—…ë¡œë“œ ë°©ì‹</p>';
            } else {
                html += '<p><strong>âŒ ì œí•œëœ í™˜ê²½</strong><br>';
                html += 'JavaScriptë§Œ ì‹¤í–‰ ê°€ëŠ¥í•©ë‹ˆë‹¤.<br>';
                html += 'ìˆ˜ë™ ì‘ì—… ë°©ì‹ì„ ê¶Œì¥í•©ë‹ˆë‹¤.</p>';
            }

            html += '</div>';

            content.innerHTML = html;
            report.style.display = 'block';
        }

        function copyReport() {
            const text = `
Comet í™˜ê²½ ì§„ë‹¨ ë³´ê³ ì„œ
ì§„ë‹¨ ì‹œê°: ${new Date().toLocaleString('ko-KR')}

1. JavaScript ì‹¤í–‰: ${results.javascript ? 'âœ… ê°€ëŠ¥' : 'âŒ ë¶ˆê°€ëŠ¥'}
2. ì™¸ë¶€ API í˜¸ì¶œ (fetch): ${results.fetchExternal ? 'âœ… ê°€ëŠ¥' : 'âŒ ë¶ˆê°€ëŠ¥'}
3. Localhost API í˜¸ì¶œ: ${results.fetchLocal ? 'âœ… ê°€ëŠ¥' : 'âŒ ë¶ˆê°€ëŠ¥'}
4. LocalStorage: ${results.localStorage ? 'âœ… ê°€ëŠ¥' : 'âŒ ë¶ˆê°€ëŠ¥'}
5. File System Access: ${results.fileSystem === 'supported_but_requires_gesture' ? 'âš ï¸ ì§€ì›ë¨ (ì‚¬ìš©ì í´ë¦­ í•„ìš”)' : results.fileSystem ? 'âœ… ê°€ëŠ¥' : 'âŒ ë¶ˆê°€ëŠ¥'}

ë¸Œë¼ìš°ì € ì •ë³´: ${navigator.userAgent}
í”Œë«í¼: ${navigator.platform}
`;

            navigator.clipboard.writeText(text).then(() => {
                alert('âœ… ì§„ë‹¨ ê²°ê³¼ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nGitHub Copilot Chatì— ë¶™ì—¬ë„£ì–´ ê³µìœ í•˜ì„¸ìš”.');
            }).catch(err => {
                alert('âŒ ë³µì‚¬ ì‹¤íŒ¨: ' + err.message);
            });
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ ì•ˆë‚´
        window.addEventListener('load', () => {
            console.log('='.repeat(60));
            console.log('ğŸš€ Comet í™˜ê²½ í…ŒìŠ¤íŠ¸ í˜ì´ì§€');
            console.log('='.repeat(60));
            console.log('ì•„ë˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ í…ŒìŠ¤íŠ¸ë¥¼ ì‹œì‘í•˜ì„¸ìš”:');
            console.log('1. ê°œë³„ í…ŒìŠ¤íŠ¸: ê° í•­ëª©ì˜ "í…ŒìŠ¤íŠ¸ ì‹¤í–‰" ë²„íŠ¼');
            console.log('2. ì „ì²´ í…ŒìŠ¤íŠ¸: "ëª¨ë“  í…ŒìŠ¤íŠ¸ í•œë²ˆì— ì‹¤í–‰" ë²„íŠ¼ (ì¶”ì²œ)');
            console.log('='.repeat(60));
        });
    </script>
</body>

</html>